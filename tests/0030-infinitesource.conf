%info
Simple performance test generating packets with InfiniteSource

%config
#Script is time-based on 2s, so if it is longer than 10s, there is a bug somewhere
timeout=10
#Accept 1% changes
acceptable=0.01
#Consider there was a problem if <1G
minimum=1000000000
tags=dpdk

%variables
BURST=[1*1024]
LENGTH=60

%script
click -j 1 CONFIG

%file CONFIG
is :: InfiniteSource(LENGTH $LENGTH, BURST $BURST)
    -> ac :: AverageCounter
    -> Discard;

finish :: Script(TYPE ACTIVE,
			wait 2s,
			print "RESULT $(ac.link_rate)",
			stop);
